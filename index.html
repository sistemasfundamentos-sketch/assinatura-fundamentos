<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gerador de Assinatura - Fundamentos</title>

<!-- Fonte Arimo -->
<link href="https://fonts.googleapis.com/css2?family=Arimo:wght@400;700&display=swap" rel="stylesheet">

<style>
  body {
    font-family: "Arimo", Arial, sans-serif;
    background:#f4f4f4;
    margin:0;
    padding:20px;
    color:#0a325c;
  }
  .wrap { max-width:1200px; margin:0 auto; }
  .form { display:flex; gap:20px; flex-wrap:wrap; align-items:flex-start; }
  .col {
    flex:1 1 320px;
    min-width:280px;
    background:#fff;
    padding:14px;
    border-radius:8px;
    box-shadow:0 6px 18px rgba(0,0,0,0.06);
  }
  label {
    display:block;
    font-weight:600;
    font-size:13px;
    margin-bottom:6px;
    color:#223;
  }
  input[type=text] {
    width:100%;
    padding:8px 10px;
    font-size:14px;
    border:1px solid #d0d7df;
    border-radius:6px;
    box-sizing:border-box;
  }
  button {
    background:#0a325c;
    color:white;
    border:0;
    padding:10px 14px;
    border-radius:6px;
    cursor:pointer;
    font-weight:600;
  }
  .preview {
    margin-top:18px;
    background:#fff;
    padding:10px;
    border-radius:8px;
    text-align:center;
  }

  /* PREVIEW — NUNCA DISTORCER */
  #canvasPreview {
    width:100%;
    height:auto;
    display:block;
  }
</style>
</head>
<body>

<div class="wrap">
  <h1>Gerador de Assinatura</h1>

  <div class="form">
    <div class="col">

      <label>Nome</label>
      <input id="nome" type="text" value="">

      <label style="margin-top:10px;">Cargo</label>
      <input id="cargo" type="text" value="">

      <label style="margin-top:10px;">Telefone</label>
      <input id="tel" type="text" value="">

      <label style="margin-top:10px;">E-mail</label>
      <input id="email" type="text" value="">

      <div style="margin-top:12px;">
        <button id="btnGen" type="button">Baixar</button>
      </div>

    </div>

    <div class="col">
      <div class="preview">
        <strong>Pré-visualização</strong>
        <div style="margin-top:10px;">
          <canvas id="canvasPreview" width="1875" height="938"></canvas>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
// ==========================
// CONFIGURAÇÃO
// ==========================
const CANVAS_W = 1875;
const CANVAS_H = 938;

const POS = {
  name:  { x: 965, y: 230 },
  role:  { x: 965, y: 305 },
  phone: { x: 1020, y: 403 },
  email: { x: 1020, y: 472 }
};

// ==========================
// CARREGAR FONTE ARIMO
// ==========================
async function loadArimo() {
  const arimo = new FontFace(
    "Arimo",
    "url(https://fonts.gstatic.com/s/arimo/v28/P5sMzZCDf9_T_3cV7q6F.woff2)"
  );
  await arimo.load();
  document.fonts.add(arimo);
}
loadArimo();

// ==========================
// CANVAS E BACKGROUND
// ==========================
const canvas = document.getElementById('canvasPreview');
const ctx = canvas.getContext('2d');
ctx.textBaseline = 'top';

const bg = new Image();
bg.src = 'https://sistemasfundamentos-sketch.github.io/assinatura-fundamentos/template-canva.png';

let bgLoaded = false;
bg.onload = () => { bgLoaded = true; renderPreview(); };

// ==========================
// DESENHAR INTERNO (base real de 1875x938)
// ==========================
function drawInternal(c) {
  c.clearRect(0,0,CANVAS_W,CANVAS_H);

  c.fillStyle = "#ffffff";
  c.fillRect(0,0,CANVAS_W,CANVAS_H);

  if (bgLoaded) {
    c.drawImage(bg, 0, 0, CANVAS_W, CANVAS_H);
  }

  const nome = document.getElementById('nome').value;
  const cargo = document.getElementById('cargo').value;
  const tel   = document.getElementById('tel').value;
  const email = document.getElementById('email').value;

  // NOME
  c.fillStyle = "#282935";
  c.font = "700 58px Arimo";
  c.fillText(nome, POS.name.x, POS.name.y);

  // CARGO
  c.fillStyle = "#282935";
  c.font = "400 40px Arimo";
  c.fillText(cargo, POS.role.x, POS.role.y);

  // TELEFONE
  c.fillStyle = "#242424";
  c.font = "400 40px Arimo";
  c.fillText(tel, POS.phone.x, POS.phone.y);

  // EMAIL
  c.fillStyle = "#242424";
  c.font = "400 40px Arimo";
  c.fillText(email, POS.email.x, POS.email.y);
}

// ==========================
// PREVIEW (escala automática sem distorcer)
// ==========================
function renderPreview() {
  drawInternal(ctx);
}

['nome','cargo','tel','email'].forEach(id =>
  document.getElementById(id).addEventListener('input', renderPreview)
);

// ==========================
// DOWNLOAD
// ==========================
document.getElementById('btnGen').addEventListener('click', async function (evt) {
  evt.preventDefault();

  await document.fonts.ready;

  // usa o próprio canvasPreview já desenhado (sem re-render)
  const sourceCanvas = document.getElementById('canvasPreview');

  sourceCanvas.toBlob(function(blob){
    if (!blob) {
      alert("Erro ao gerar imagem.");
      return;
    }

    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "assinatura_final.png";
    a.click();

    setTimeout(() => URL.revokeObjectURL(url), 200);

  }, "image/png");
});

</script>

</body>
</html>


